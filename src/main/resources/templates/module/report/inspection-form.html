<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<link rel="stylesheet" type="text/css" th:href="@{/static/css/header.css}">
	<link rel="stylesheet" type="text/css" th:href="@{/static/css/sidebar.css}">
	<link rel="stylesheet" type="text/css" th:href="@{/static/css/index.css}">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<script th:src="@{/static/js/sidebar.js}"></script>
	<title>巡檢報表</title>
</head>
<style>
	table {
		width: 100%;
		border-collapse: collapse;
		margin: 20px 0;
		box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
	}

	th,
	td {
		padding: 12px;
		text-align: center;
		border: 1px solid #ddd;
	}

	th {
		background-color: #d0d0d0;
		/* Grey 25% */
		color: black;
		font-weight: bold;
	}

	tr:nth-child(even) {
		background-color: #f2f2f2;
	}

	tr:hover {
		background-color: #ddd !important;
	}

	.date-cell {
		background-color: #f2f2f2;
		/* Light grey */
	}

	.process-cell {
		background-color: #d0f0c0;
		/* Light green */
		color: #006400;
		/* Dark green font */
	}

	.position-cell-gray {
		background-color: #d0d0d0;
		/* Grey 25% */
	}

	.position-cell-orange {
		background-color: #ffa500;
		/* Orange */
	}

	.position-cell-red {
		background-color: #ff0000;
		/* Red */
	}

	.days-cell-pink {
		background-color: #ffc0cb;
		/* Pink */
	}

	.days-cell-gray40 {
		background-color: #cccccc;
		/* Grey 40% */
	}

	.days-cell-gray25 {
		background-color: #d0d0d0;
		/* Grey 25% */
	}

	.days-cell-gray50 {
		background-color: #b3b3b3;
		/* Grey 50% */
	}

	.boron-cell {
		background-color: #e6f7ff;
		/* Light blue */
	}

	.yellowing-cell {
		background-color: #ffffe6;
		/* Light yellow */
	}

	.elongation-cell {
		background-color: #d0f0c0;
		/* Light green */
	}

	.browning-cell {
		background-color: #ffcc99;
		/* Light orange */
	}

	.growth-cell {
		background-color: #d0d0d0;
		/* Grey 25% */
	}

	.pest-cell {
		background-color: #e6f7ff;
		/* Light blue */
	}

	.other-cell {
		background-color: #d0f0c0;
		/* Light green */
	}

	.days-cell-pink {
		background-color: pink;
	}

	.days-cell-gray40 {
		background-color: #666;
		/* gray40 color */
	}

	.days-cell-gray25 {
		background-color: #999;
		/* gray25 color */
	}

	.days-cell-gray50 {
		background-color: #333;
		/* gray50 color */
	}

	.filer-form {
		display: flex;
		justify-content: right;
	}
</style>

<body>
	<div th:include="layout/header::header(userDetails)"></div>
	<div class="main-container">
		<div th:replace="layout/sidebar::sidebar(${session.menus})" class="sidebar"></div>
		<div class="main-content">
			<!-- 這裡是主要內容區域 -->
			<header>
				<h1>巡檢報表</h1>
			</header>
			<main>
				<form method="get" action="/report/group-techology" class="filer-form">
					<div class="date-filter ml-5">
						<label for="hStartDate">採收開始日期:</label> <input type="date" id="hStartDate" name="hStartDate"
							th:value="${hStartDate}">

						<label for="hEndDate">採收結束日期:</label> <input type="date" id="hEndDate" name="hEndDate"
							th:value="${hEndDate}">
					</div>

					<div class="item-count-filter ml-5">
						<label for="size">顯示筆數:</label> <select id="size" name="size">
							<option th:each="option : ${session.options}" th:value="${option}" th:text="${option}"
								th:selected="${option == size}"></option>
						</select>
					</div>

					<button class="ml-5" type="submit">搜尋</button>
				</form>
				<table>
					<thead>
						<tr>
							<th>工單號</th>
							<th>品名</th>
							<th>G孔數</th>
							<th>H盤數</th>
							<th>H孔數</th>
							<th>定案採收日</th>
							<th>目前儲位</th>
							<th>移入天數</th>
							<th>理想株高</th>
							<th>實際株高</th>
							<th>缺硼</th>
							<th>%</th>
							<th>黃化</th>
							<th>%</th>
							<th>徒長</th>
							<th>%</th>
							<th>褐化</th>
							<th>%</th>
							<th>長勢</th>
							<th>%</th>
							<th>蟲害</th>
							<th>%</th>
							<th>其他</th>
							<th>%</th>
							<th>備註</th>
						</tr>
					</thead>
					<tbody>
						<tr th:each="qcReport : ${qcReports.content}">
							<td th:text="${qcReport.manuNo}"></td>
							<td th:text="${qcReport.productName}"></td>
							<td>G孔數</td>
							<td th:text="${qcReport.actBoardCount}"></td>
							<td>H孔數</td>
							<td class="date-cell" th:text="${#dates.format(qcReport.estHarvestDate, 'MM-dd')}"></td>
							<td th:text="${qcReport.position}" th:classappend="${qcReport.plantLux != null && qcReport.stockLux != null} ? 
							                   (${qcReport.plantLux.equals(qcReport.stockLux)} ? 'position-cell-gray' :
							                   (${qcReport.plantLux < qcReport.stockLux} ? 'position-cell-orange' : 'position-cell-red'))">
							</td>
							<td th:if="${qcReport.dayNumber > 14}" th:text="${qcReport.dayNumber}"
								class="days-cell-pink"></td>
							<td th:if="${qcReport.dayNumber == 7}" th:text="${qcReport.dayNumber}"
								class="days-cell-gray40"></td>
							<td th:if="${qcReport.dayNumber <= 1}" th:text="${qcReport.dayNumber}"
								class="days-cell-gray25"></td>
							<td th:if="${qcReport.dayNumber == 4}" th:text="${qcReport.dayNumber}"
								class="days-cell-gray50"></td>
							<!-- 默認空白欄位，用於保證所有情況都有一個td元素 -->
							<td th:unless="${qcReport.dayNumber > 14 or qcReport.dayNumber == 7 or qcReport.dayNumber <= 1 or qcReport.dayNumber == 4}"
								th:text="${qcReport.dayNumber}" class="days-cell-default"></td>
							<td th:text="${qcReport.idealHeight}"></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
						</tr>
					</tbody>
				</table>

				<div class="pagination">
					<span th:if="${qcReports.hasPrevious()}"> <a
							th:href="@{/report/group-techology(page=${qcReports.number - 1}, size=${size}, hStartDate=${hStartDate}, hEndDate=${hEndDate})}">上一頁</a>
					</span> <span th:if="${qcReports.hasNext()}"> <a
							th:href="@{/report/group-techology(page=${qcReports.number + 1}, size=${size}, hStartDate=${hStartDate}, hEndDate=${hEndDate})}">下一頁</a>
					</span>
				</div>
			</main>

			<footer>
				<p>&copy; 2024 我的公司</p>
			</footer>
		</div>
	</div>
</body>

</html>